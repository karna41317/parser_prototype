var Parsimmon={};Parsimmon.Parser=function(){"use strict";function r(n){if(!(this instanceof r))return new r(n);this._=n}var n=r.prototype;function t(r,n){return{status:true,index:r,value:n,furthest:-1,expected:[]}}function e(r,n){return{status:false,index:-1,value:null,furthest:r,expected:[n]}}function u(r,n){if(!n)return r;if(r.furthest>n.furthest)return r;var t=r.furthest===n.furthest?r.expected.concat(n.expected):n.expected;return{status:r.status,index:r.index,value:r.value,furthest:n.furthest,expected:t}}function a(n){if(!(n instanceof r))throw new Error("not a parser: "+n)}function i(r){if(r.length===1)return r[0];return"one of "+r.join(", ")}function s(r,n){var t=n.index;if(t===r.length)return", got the end of the stream";var e=t>0?"'...":"'";var u=r.length-t>12?"...'":"'";return" at character "+t+", got "+e+r.slice(t,t+12)+u}var o=Parsimmon.formatError=function(r,n){return"expected "+i(n.expected)+s(r,n)};n.parse=function(r){var n=this.skip(E)._(r,0);return n.status?{status:true,value:n.value}:{status:false,index:n.furthest,expected:n.expected}};var f=Parsimmon.seq=function(){var n=[].slice.call(arguments);var e=n.length;return r(function(r,a){var i;var s=new Array(e);for(var o=0;o<e;o+=1){i=u(n[o]._(r,a),i);if(!i.status)return i;s[o]=i.value;a=i.index}return u(t(a,s),i)})};var c=Parsimmon.seqMap=function(){var r=[].slice.call(arguments);var n=r.pop();return f.apply(null,r).map(function(r){return n.apply(null,r)})};var v=Parsimmon.custom=function(n){return r(n(t,e))};var l=Parsimmon.alt=function(){var n=[].slice.call(arguments);var t=n.length;if(t===0)return d("zero alternates");return r(function(r,t){var e;for(var a=0;a<n.length;a+=1){e=u(n[a]._(r,t),e);if(e.status)return e}return e})};n.or=function(r){return l(this,r)};n.then=function(r){if(typeof r==="function"){throw new Error("chaining features of .then are no longer supported, use .chain instead")}a(r);return f(this,r).map(function(r){return r[1]})};n.many=function(){var n=this;return r(function(r,e){var a=[];var i;var s;for(;;){i=u(n._(r,e),i);if(i.status){e=i.index;a.push(i.value)}else{return u(t(e,a),i)}}})};n.times=function(n,e){if(arguments.length<2)e=n;var a=this;return r(function(r,i){var s=[];var o=i;var f;var c;for(var v=0;v<n;v+=1){f=a._(r,i);c=u(f,c);if(f.status){i=f.index;s.push(f.value)}else return c}for(;v<e;v+=1){f=a._(r,i);c=u(f,c);if(f.status){i=f.index;s.push(f.value)}else break}return u(t(i,s),c)})};n.result=function(r){return this.map(function(n){return r})};n.atMost=function(r){return this.times(0,r)};n.atLeast=function(r){var n=this;return c(this.times(r),this.many(),function(r,n){return r.concat(n)})};n.map=function(n){var e=this;return r(function(r,a){var i=e._(r,a);if(!i.status)return i;return u(t(i.index,n(i.value)),i)})};n.skip=function(r){return f(this,r).map(function(r){return r[0]})};n.mark=function(){return c(b,this,b,function(r,n,t){return{start:r,value:n,end:t}})};n.desc=function(n){var t=this;return r(function(r,e){var u=t._(r,e);if(!u.status)u.expected=[n];return u})};var m=Parsimmon.string=function(n){var u=n.length;var a="'"+n+"'";return r(function(r,i){var s=r.slice(i,i+u);if(s===n){return t(i+u,s)}else{return e(i,a)}})};var h=Parsimmon.regex=function(n,u){var a=RegExp("^(?:"+n.source+")",(""+n).slice((""+n).lastIndexOf("/")+1));var i=""+n;if(u==null)u=0;return r(function(r,n){var s=a.exec(r.slice(n));if(s){var o=s[0];var f=s[u];if(f!=null)return t(n+o.length,f)}return e(n,i)})};var p=Parsimmon.succeed=function(n){return r(function(r,e){return t(e,n)})};var d=Parsimmon.fail=function(n){return r(function(r,t){return e(t,n)})};var g=Parsimmon.letter=h(/[a-z]/i).desc("a letter");var x=Parsimmon.letters=h(/[a-z]*/i);var P=Parsimmon.digit=h(/[0-9]/).desc("a digit");var _=Parsimmon.digits=h(/[0-9]*/);var y=Parsimmon.whitespace=h(/\s+/).desc("whitespace");var w=Parsimmon.optWhitespace=h(/\s*/);var O=Parsimmon.any=r(function(r,n){if(n>=r.length)return e(n,"any character");return t(n+1,r.charAt(n))});var k=Parsimmon.all=r(function(r,n){return t(r.length,r.slice(n))});var E=Parsimmon.eof=r(function(r,n){if(n<r.length)return e(n,"EOF");return t(n,null)});var z=Parsimmon.test=function(n){return r(function(r,u){var a=r.charAt(u);if(u<r.length&&n(a)){return t(u+1,a)}else{return e(u,"a character matching "+n)}})};var A=Parsimmon.oneOf=function(r){return z(function(n){return r.indexOf(n)>=0})};var q=Parsimmon.noneOf=function(r){return z(function(n){return r.indexOf(n)<0})};var M=Parsimmon.takeWhile=function(n){return r(function(r,e){var u=e;while(u<r.length&&n(r.charAt(u)))u+=1;return t(u,r.slice(e,u))})};var W=Parsimmon.lazy=function(n,t){if(arguments.length<2){t=n;n=undefined}var e=r(function(r,n){e._=t()._;return e._(r,n)});if(n)e=e.desc(n);return e};var b=Parsimmon.index=r(function(r,n){return t(n,n)});n.concat=n.or;n.empty=d("empty");n.of=r.of=Parsimmon.of=p;n.ap=function(r){return c(this,r,function(r,n){return r(n)})};n.chain=function(n){var t=this;return r(function(r,e){var a=t._(r,e);if(!a.status)return a;var i=n(a.value);return u(i._(r,a.index),a)})};return r}();